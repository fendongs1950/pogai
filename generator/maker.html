<!DOCTYPE html>
<html lang="zh-CN">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>POGAI熊猫头表情包合成器</title>
  <link rel="icon" href="favicon.png" type="image/png">
  <link rel="stylesheet" href="style.css">
  <script src="https://cdn.jsdelivr.net/npm/vue@2.6.14/dist/vue.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/fabric.js/5.3.1/fabric.min.js"></script>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
</head>

<body>
  <div id="app" class="app">
    <h1 class="meme-title">
      <span class="emoji">😜</span> 
      熊猫头合成器 
      <span class="emoji">😂</span>
    </h1>

    <div class="editor-container">
      <!-- 左侧工具栏 -->
      <div class="toolbar">
        
        <!-- 模板选择 -->
        <div class="tool-section">
          <h3 @click="toggleSection('templates')">
            <i :class="activeSections.templates ? 'fa-chevron-down' : 'fa-chevron-right'" class="fas"></i>
            表情类型
          </h3>
          <div class="section-content" v-show="activeSections.templates">
            <button v-for="template in memeTypeData" :key="template.id" class="template-btn"
              :class="{ 'active': DefaultType === template.id }" @click="selectTemplate(template)">
              {{ template.name }}
            </button>
          </div>
        </div>

        <!-- 文字工具 -->
        <div class="tool-section">
          <h3 @click="toggleSection('text')">
            <i :class="activeSections.text ? 'fa-chevron-down' : 'fa-chevron-right'" class="fas"></i>
            文字工具
          </h3>
          <div class="section-content" v-show="activeSections.text">
            <input type="text" v-model="textContent" placeholder="输入文字内容" @keyup.enter="addText">
            <label>字体大小: {{ fontSize }}px</label>
            <input type="range" v-model="fontSize" min="10" max="100">
            <label>文字颜色</label>
            <input type="color" style="height: 40px;" v-model="textColor">
            <label>描边颜色</label>
            <input type="color" style="height: 40px;" v-model="strokeColor">
            <button @click="addText">
              <i class="fas fa-font"></i> 添加文字
            </button>
            <button class="delete-btn" @click="deleteSelected">
              <i class="fas fa-trash"></i> 删除选中项
            </button>
          </div>
        </div>

        <!-- 贴纸工具 -->
        <div class="tool-section">
          <h3 @click="toggleSection('stickers')">
            <i :class="activeSections.stickers ? 'fa-chevron-down' : 'fa-chevron-right'" class="fas"></i>
            贴纸工具
          </h3>
          <div class="section-content" v-show="activeSections.stickers">
            <div class="sticker-grid">
              <div v-for="(sticker, index) in stickers" :key="index" class="sticker-item" @click="addSticker(sticker)">
                {{ sticker }}
              </div>
            </div>
          </div>
        </div>
        <!-- 上传图片 -->
        <div class="tool-section">
          <h3 @click="toggleSection('upload')">
            <i :class="activeSections.upload ? 'fa-chevron-down' : 'fa-chevron-right'" class="fas"></i>
            上传图片
          </h3>
          <div class="section-content" v-show="activeSections.upload">
            <button style="position: relative;" >
              <input type="file" id="image-upload" accept="image/*" @change="handleImageUpload" style="width: 100%;height: 100%;position: absolute;top:
              0;left: 0;opacity: 0;cursor: pointer;">
              <i class="fas fa-upload"></i> 选择图片
            </button>
          </div>
        </div>
        <!-- 水印设置 -->
        <div class="tool-section" style="display: none;">
          <h3 @click="toggleSection('watermark')">
            <i :class="activeSections.watermark ? 'fa-chevron-down' : 'fa-chevron-right'" class="fas"></i>
            水印设置
          </h3>
          <div class="section-content" v-show="activeSections.watermark">
            <div class="watermark-controls">
              <input type="checkbox" id="watermark-toggle" v-model="showWatermark">
              <label for="watermark-toggle">显示水印</label>
            </div>
            <input type="text" v-model="watermarkText" placeholder="水印文字">
            <button @click="applyWatermark">
              <i class="fas fa-stamp"></i> 应用水印
            </button>
          </div>
        </div>

        <!-- 导出 -->
        <div class="tool-section">
          <button @click="exportImage" class="export-btn">
            <i class="fas fa-download"></i> 导出表情包
          </button>
        </div>
      </div>

      <!-- 右侧画布区域 -->
      <div class="canvas-container">
        <canvas id="canvas" width="500" height="500"></canvas>
        <div style="display:flex;justify-content:center;align-items:center;width:100%">
          <button @click="randomLoadTemplate()" class="change-image-btn">
          <i class="fas fa-sync-alt"></i> 切换图片
        </button></div>
        <div class="canvas-tip">
          <p>提示：</p>
          <p>- 拖动元素可移动位置</p>
          <p>- 拖动角落可缩放大小</p>
          <p>- 拖动上方可旋转</p>
          <p>- 选中元素后按Delete键可删除</p>
        </div>
      </div>
    </div>
  </div>

  <script src="app.js"></script>
</body>

</html>